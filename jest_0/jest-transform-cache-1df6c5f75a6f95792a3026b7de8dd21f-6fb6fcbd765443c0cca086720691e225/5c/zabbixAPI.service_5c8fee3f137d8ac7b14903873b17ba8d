0abb8a3aafa25409ed00303be9a48672
'use strict';var _slicedToArray = function () {function sliceIterator(arr, i) {var _arr = [];var _n = true;var _d = false;var _e = undefined;try {for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {_arr.push(_s.value);if (i && _arr.length === i) break;}} catch (err) {_d = true;_e = err;} finally {try {if (!_n && _i["return"]) _i["return"]();} finally {if (_d) throw _e;}}return _arr;}return function (arr, i) {if (Array.isArray(arr)) {return arr;} else if (Symbol.iterator in Object(arr)) {return sliceIterator(arr, i);} else {throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();var _createClass = function () {function defineProperties(target, props) {for (var i = 0; i < props.length; i++) {var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);}}return function (Constructor, protoProps, staticProps) {if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;};}();var _angular = require('angular');var _angular2 = _interopRequireDefault(_angular);
var _lodash = require('lodash');var _lodash2 = _interopRequireDefault(_lodash);
var _utils = require('./utils');var utils = _interopRequireWildcard(_utils);
require('./zabbixAPICore.service');function _interopRequireWildcard(obj) {if (obj && obj.__esModule) {return obj;} else {var newObj = {};if (obj != null) {for (var key in obj) {if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];}}newObj.default = obj;return newObj;}}function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _classCallCheck(instance, Constructor) {if (!(instance instanceof Constructor)) {throw new TypeError("Cannot call a class as a function");}}

/** @ngInject */
function ZabbixAPIServiceFactory(alertSrv, zabbixAPICoreService) {

  /**
                                                                   * Zabbix API Wrapper.
                                                                   * Creates Zabbix API instance with given parameters (url, credentials and other).
                                                                   * Wraps API calls and provides high-level methods.
                                                                   */var
  ZabbixAPI = function () {

    function ZabbixAPI(api_url, username, password, basicAuth, withCredentials) {_classCallCheck(this, ZabbixAPI);
      this.url = api_url;
      this.username = username;
      this.password = password;
      this.auth = "";

      this.requestOptions = {
        basicAuth: basicAuth,
        withCredentials: withCredentials };


      this.loginPromise = null;
      this.loginErrorCount = 0;
      this.maxLoginAttempts = 3;

      this.alertSrv = alertSrv;
      this.zabbixAPICore = zabbixAPICoreService;

      this.getTrend = this.getTrend_ZBXNEXT1193;
      //getTrend = getTrend_30;
    }

    //////////////////////////
    // Core method wrappers //
    //////////////////////////
    _createClass(ZabbixAPI, [{ key: 'request', value: function request(
      method, params) {var _this = this;
        return this.zabbixAPICore.request(this.url, method, params, this.requestOptions, this.auth).
        catch(function (error) {
          if (isNotAuthorized(error.data)) {
            // Handle auth errors
            _this.loginErrorCount++;
            if (_this.loginErrorCount > _this.maxLoginAttempts) {
              _this.loginErrorCount = 0;
              return null;
            } else {
              return _this.loginOnce().
              then(function () {return _this.request(method, params);});
            }
          } else {
            // Handle API errors
            var message = error.data ? error.data : error.statusText;
            _this.alertAPIError(message);
          }
        });
      } }, { key: 'alertAPIError', value: function alertAPIError(

      message) {var timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5000;
        this.alertSrv.set(
        "Zabbix API Error",
        message,
        'error',
        timeout);

      }

      /**
         * When API unauthenticated or auth token expired each request produce login()
         * call. But auth token is common to all requests. This function wraps login() method
         * and call it once. If login() already called just wait for it (return its promise).
         * @return login promise
         */ }, { key: 'loginOnce', value: function loginOnce()
      {var _this2 = this;
        if (!this.loginPromise) {
          this.loginPromise = Promise.resolve(
          this.login().then(function (auth) {
            _this2.auth = auth;
            _this2.loginPromise = null;
            return auth;
          }));

        }
        return this.loginPromise;
      }

      /**
         * Get authentication token.
         */ }, { key: 'login', value: function login()
      {
        return this.zabbixAPICore.login(this.url, this.username, this.password, this.requestOptions);
      }

      /**
         * Get Zabbix API version
         */ }, { key: 'getVersion', value: function getVersion()
      {
        return this.zabbixAPICore.getVersion(this.url, this.requestOptions);
      }

      ////////////////////////////////
      // Zabbix API method wrappers //
      ////////////////////////////////
    }, { key: 'acknowledgeEvent', value: function acknowledgeEvent(
      eventid, message) {
        var params = {
          eventids: eventid,
          message: message };


        return this.request('event.acknowledge', params);
      } }, { key: 'getGroups', value: function getGroups()

      {
        var params = {
          output: ['name'],
          sortfield: 'name',
          real_hosts: true };


        return this.request('hostgroup.get', params);
      } }, { key: 'getHosts', value: function getHosts(

      groupids) {
        var params = {
          output: ['name', 'host'],
          sortfield: 'name' };

        if (groupids) {
          params.groupids = groupids;
        }

        return this.request('host.get', params);
      } }, { key: 'getApps', value: function getApps(

      hostids) {
        var params = {
          output: 'extend',
          hostids: hostids };


        return this.request('application.get', params);
      }

      /**
         * Get Zabbix items
         * @param  {[type]} hostids  host ids
         * @param  {[type]} appids   application ids
         * @param  {String} itemtype 'num' or 'text'
         * @return {[type]}          array of items
         */ }, { key: 'getItems', value: function getItems(
      hostids, appids, itemtype) {
        var params = {
          output: [
          'name', 'key_',
          'value_type',
          'hostid',
          'status',
          'state'],

          sortfield: 'name',
          webitems: true,
          filter: {},
          selectHosts: ['hostid', 'name'] };

        if (hostids) {
          params.hostids = hostids;
        }
        if (appids) {
          params.applicationids = appids;
        }
        if (itemtype === 'num') {
          // Return only numeric metrics
          params.filter.value_type = [0, 3];
        }
        if (itemtype === 'text') {
          // Return only text metrics
          params.filter.value_type = [1, 2, 4];
        }

        return this.request('item.get', params).
        then(utils.expandItems);
      } }, { key: 'getItemsByIDs', value: function getItemsByIDs(

      itemids) {
        var params = {
          itemids: itemids,
          output: [
          'name', 'key_',
          'value_type',
          'hostid',
          'status',
          'state'],

          webitems: true,
          selectHosts: ['hostid', 'name'] };


        return this.request('item.get', params).
        then(utils.expandItems);
      } }, { key: 'getMacros', value: function getMacros(

      hostids) {
        var params = {
          output: 'extend',
          hostids: hostids };


        return this.request('usermacro.get', params);
      } }, { key: 'getGlobalMacros', value: function getGlobalMacros()

      {
        var params = {
          output: 'extend',
          globalmacro: true };


        return this.request('usermacro.get', params);
      } }, { key: 'getLastValue', value: function getLastValue(

      itemid) {
        var params = {
          output: ['lastvalue'],
          itemids: itemid };

        return this.request('item.get', params).
        then(function (items) {return items.length ? items[0].lastvalue : null;});
      }

      /**
         * Perform history query from Zabbix API
         *
         * @param  {Array}  items       Array of Zabbix item objects
         * @param  {Number} timeFrom   Time in seconds
         * @param  {Number} timeTill   Time in seconds
         * @param  {Number} limit[optional] Limite
         * @return {Array}  Array of Zabbix history objects
         */ }, { key: 'getHistory', value: function getHistory(
      items, timeFrom, timeTill, limit) {var _this3 = this;

        // Group items by value type and perform request for each value type
        var grouped_items = _lodash2.default.groupBy(items, 'value_type');
        var promises = _lodash2.default.map(grouped_items, function (items, value_type) {
          var itemids = _lodash2.default.map(items, 'itemid');
          var params = {
            output: 'extend',
            history: value_type,
            itemids: itemids,
            sortfield: 'clock',
            sortorder: 'ASC',
            time_from: timeFrom };

          if (limit) {
            params.limit = limit;
          }

          // Relative queries (e.g. last hour) don't include an end time
          if (timeTill) {
            params.time_till = timeTill;
          }

          return _this3.request('history.get', params);
        });

        return Promise.all(promises).then(_lodash2.default.flatten);
      }

      /**
         * Perform trends query from Zabbix API
         * Use trends api extension from ZBXNEXT-1193 patch.
         *
         * @param  {Array}  items       Array of Zabbix item objects
         * @param  {Number} time_from   Time in seconds
         * @param  {Number} time_till   Time in seconds
         * @return {Array}  Array of Zabbix trend objects
         */ }, { key: 'getTrend_ZBXNEXT1193', value: function getTrend_ZBXNEXT1193(
      items, timeFrom, timeTill) {var _this4 = this;

        // Group items by value type and perform request for each value type
        var grouped_items = _lodash2.default.groupBy(items, 'value_type');
        var promises = _lodash2.default.map(grouped_items, function (items, value_type) {
          var itemids = _lodash2.default.map(items, 'itemid');
          var params = {
            output: 'extend',
            trend: value_type,
            itemids: itemids,
            sortfield: 'clock',
            sortorder: 'ASC',
            time_from: timeFrom };


          // Relative queries (e.g. last hour) don't include an end time
          if (timeTill) {
            params.time_till = timeTill;
          }

          return _this4.request('trend.get', params);
        });

        return Promise.all(promises).then(_lodash2.default.flatten);
      } }, { key: 'getTrend_30', value: function getTrend_30(

      items, time_from, time_till, value_type) {
        var self = this;
        var itemids = _lodash2.default.map(items, 'itemid');

        var params = {
          output: ["itemid",
          "clock",
          value_type],

          itemids: itemids,
          time_from: time_from };


        // Relative queries (e.g. last hour) don't include an end time
        if (time_till) {
          params.time_till = time_till;
        }

        return self.request('trend.get', params);
      } }, { key: 'getITService', value: function getITService(

      serviceids) {
        var params = {
          output: 'extend',
          serviceids: serviceids };

        return this.request('service.get', params);
      } }, { key: 'getSLA', value: function getSLA(

      serviceids, timeRange) {var _timeRange = _slicedToArray(
        timeRange, 2),timeFrom = _timeRange[0],timeTo = _timeRange[1];
        var params = {
          serviceids: serviceids,
          intervals: [{
            from: timeFrom,
            to: timeTo }] };


        return this.request('service.getsla', params);
      } }, { key: 'getTriggers', value: function getTriggers(

      groupids, hostids, applicationids, options) {var
        showTriggers = options.showTriggers,maintenance = options.maintenance,timeFrom = options.timeFrom,timeTo = options.timeTo;

        var params = {
          output: 'extend',
          groupids: groupids,
          hostids: hostids,
          applicationids: applicationids,
          expandDescription: true,
          expandData: true,
          expandComment: true,
          monitored: true,
          skipDependent: true,
          //only_true: true,
          filter: {
            value: 1 },

          selectGroups: ['name'],
          selectHosts: ['name', 'host', 'maintenance_status'],
          selectItems: ['name', 'key_', 'lastvalue'],
          selectLastEvent: 'extend',
          selectTags: 'extend' };


        if (showTriggers) {
          params.filter.value = showTriggers;
        }

        if (maintenance) {
          params.maintenance = true;
        }

        if (timeFrom || timeTo) {
          params.lastChangeSince = timeFrom;
          params.lastChangeTill = timeTo;
        }

        return this.request('trigger.get', params);
      } }, { key: 'getEvents', value: function getEvents(

      objectids, timeFrom, timeTo, showEvents) {
        var params = {
          output: 'extend',
          time_from: timeFrom,
          time_till: timeTo,
          objectids: objectids,
          select_acknowledges: 'extend',
          selectHosts: 'extend',
          value: showEvents };


        return this.request('event.get', params);
      } }, { key: 'getAcknowledges', value: function getAcknowledges(

      eventids) {
        var params = {
          output: 'extend',
          eventids: eventids,
          preservekeys: true,
          select_acknowledges: 'extend',
          sortfield: 'clock',
          sortorder: 'DESC' };


        return this.request('event.get', params).
        then(function (events) {
          return _lodash2.default.filter(events, function (event) {return event.acknowledges.length;});
        });
      } }, { key: 'getAlerts', value: function getAlerts(

      itemids, timeFrom, timeTo) {
        var params = {
          output: 'extend',
          itemids: itemids,
          expandDescription: true,
          expandData: true,
          expandComment: true,
          monitored: true,
          skipDependent: true,
          //only_true: true,
          // filter: {
          //   value: 1
          // },
          selectLastEvent: 'extend' };


        if (timeFrom || timeTo) {
          params.lastChangeSince = timeFrom;
          params.lastChangeTill = timeTo;
        }

        return this.request('trigger.get', params);
      } }, { key: 'getHostAlerts', value: function getHostAlerts(

      hostids, applicationids, options) {var
        minSeverity = options.minSeverity,acknowledged = options.acknowledged,count = options.count,timeFrom = options.timeFrom,timeTo = options.timeTo;
        var params = {
          output: 'extend',
          hostids: hostids,
          min_severity: minSeverity,
          filter: { value: 1 },
          expandDescription: true,
          expandData: true,
          expandComment: true,
          monitored: true,
          skipDependent: true,
          selectLastEvent: 'extend',
          selectGroups: 'extend',
          selectHosts: ['host', 'name'] };


        if (count && acknowledged !== 0 && acknowledged !== 1) {
          params.countOutput = true;
        }

        if (applicationids && applicationids.length) {
          params.applicationids = applicationids;
        }

        if (timeFrom || timeTo) {
          params.lastChangeSince = timeFrom;
          params.lastChangeTill = timeTo;
        }

        return this.request('trigger.get', params).
        then(function (triggers) {
          if (!count || acknowledged === 0 || acknowledged === 1) {
            triggers = filterTriggersByAcknowledge(triggers, acknowledged);
            if (count) {
              triggers = triggers.length;
            }
          }
          return triggers;
        });
      } }]);return ZabbixAPI;}();


  return ZabbixAPI;
}

function filterTriggersByAcknowledge(triggers, acknowledged) {
  if (acknowledged === 0) {
    return _lodash2.default.filter(triggers, function (trigger) {return trigger.lastEvent.acknowledged === "0";});
  } else if (acknowledged === 1) {
    return _lodash2.default.filter(triggers, function (trigger) {return trigger.lastEvent.acknowledged === "1";});
  } else {
    return triggers;
  }
}

function isNotAuthorized(message) {
  return (
    message === "Session terminated, re-login, please." ||
    message === "Not authorised." ||
    message === "Not authorized.");

}

_angular2.default.
module('grafana.services').
factory('zabbixAPIService', ZabbixAPIServiceFactory);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInphYmJpeEFQSS5zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbInV0aWxzIiwiWmFiYml4QVBJU2VydmljZUZhY3RvcnkiLCJhbGVydFNydiIsInphYmJpeEFQSUNvcmVTZXJ2aWNlIiwiWmFiYml4QVBJIiwiYXBpX3VybCIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJiYXNpY0F1dGgiLCJ3aXRoQ3JlZGVudGlhbHMiLCJ1cmwiLCJhdXRoIiwicmVxdWVzdE9wdGlvbnMiLCJsb2dpblByb21pc2UiLCJsb2dpbkVycm9yQ291bnQiLCJtYXhMb2dpbkF0dGVtcHRzIiwiemFiYml4QVBJQ29yZSIsImdldFRyZW5kIiwiZ2V0VHJlbmRfWkJYTkVYVDExOTMiLCJtZXRob2QiLCJwYXJhbXMiLCJyZXF1ZXN0IiwiY2F0Y2giLCJpc05vdEF1dGhvcml6ZWQiLCJlcnJvciIsImRhdGEiLCJsb2dpbk9uY2UiLCJ0aGVuIiwibWVzc2FnZSIsInN0YXR1c1RleHQiLCJhbGVydEFQSUVycm9yIiwidGltZW91dCIsInNldCIsIlByb21pc2UiLCJyZXNvbHZlIiwibG9naW4iLCJnZXRWZXJzaW9uIiwiZXZlbnRpZCIsImV2ZW50aWRzIiwib3V0cHV0Iiwic29ydGZpZWxkIiwicmVhbF9ob3N0cyIsImdyb3VwaWRzIiwiaG9zdGlkcyIsImFwcGlkcyIsIml0ZW10eXBlIiwid2ViaXRlbXMiLCJmaWx0ZXIiLCJzZWxlY3RIb3N0cyIsImFwcGxpY2F0aW9uaWRzIiwidmFsdWVfdHlwZSIsImV4cGFuZEl0ZW1zIiwiaXRlbWlkcyIsImdsb2JhbG1hY3JvIiwiaXRlbWlkIiwiaXRlbXMiLCJsZW5ndGgiLCJsYXN0dmFsdWUiLCJ0aW1lRnJvbSIsInRpbWVUaWxsIiwibGltaXQiLCJncm91cGVkX2l0ZW1zIiwiXyIsImdyb3VwQnkiLCJwcm9taXNlcyIsIm1hcCIsImhpc3RvcnkiLCJzb3J0b3JkZXIiLCJ0aW1lX2Zyb20iLCJ0aW1lX3RpbGwiLCJhbGwiLCJmbGF0dGVuIiwidHJlbmQiLCJzZWxmIiwic2VydmljZWlkcyIsInRpbWVSYW5nZSIsInRpbWVUbyIsImludGVydmFscyIsImZyb20iLCJ0byIsIm9wdGlvbnMiLCJzaG93VHJpZ2dlcnMiLCJtYWludGVuYW5jZSIsImV4cGFuZERlc2NyaXB0aW9uIiwiZXhwYW5kRGF0YSIsImV4cGFuZENvbW1lbnQiLCJtb25pdG9yZWQiLCJza2lwRGVwZW5kZW50IiwidmFsdWUiLCJzZWxlY3RHcm91cHMiLCJzZWxlY3RJdGVtcyIsInNlbGVjdExhc3RFdmVudCIsInNlbGVjdFRhZ3MiLCJsYXN0Q2hhbmdlU2luY2UiLCJsYXN0Q2hhbmdlVGlsbCIsIm9iamVjdGlkcyIsInNob3dFdmVudHMiLCJzZWxlY3RfYWNrbm93bGVkZ2VzIiwicHJlc2VydmVrZXlzIiwiZXZlbnRzIiwiZXZlbnQiLCJhY2tub3dsZWRnZXMiLCJtaW5TZXZlcml0eSIsImFja25vd2xlZGdlZCIsImNvdW50IiwibWluX3NldmVyaXR5IiwiY291bnRPdXRwdXQiLCJ0cmlnZ2VycyIsImZpbHRlclRyaWdnZXJzQnlBY2tub3dsZWRnZSIsInRyaWdnZXIiLCJsYXN0RXZlbnQiLCJhbmd1bGFyIiwibW9kdWxlIiwiZmFjdG9yeSJdLCJtYXBwaW5ncyI6IjBxQ0FBQSxrQztBQUNBLGdDO0FBQ0EsZ0MsSUFBWUEsSztBQUNaLG1DOztBQUVBO0FBQ0EsU0FBU0MsdUJBQVQsQ0FBaUNDLFFBQWpDLEVBQTJDQyxvQkFBM0MsRUFBaUU7O0FBRS9EOzs7O3FFQUYrRDtBQU96REMsV0FQeUQ7O0FBUzdELHVCQUFZQyxPQUFaLEVBQXFCQyxRQUFyQixFQUErQkMsUUFBL0IsRUFBeUNDLFNBQXpDLEVBQW9EQyxlQUFwRCxFQUFxRTtBQUNuRSxXQUFLQyxHQUFMLEdBQXdCTCxPQUF4QjtBQUNBLFdBQUtDLFFBQUwsR0FBd0JBLFFBQXhCO0FBQ0EsV0FBS0MsUUFBTCxHQUF3QkEsUUFBeEI7QUFDQSxXQUFLSSxJQUFMLEdBQXdCLEVBQXhCOztBQUVBLFdBQUtDLGNBQUwsR0FBc0I7QUFDcEJKLG1C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a0JQLFlBQWxCLEtBQW1DLEdBQWhELEVBQW5CLENBQVA7QUFDRCxHQUZELE1BRU8sSUFBSUEsaUJBQWlCLENBQXJCLEVBQXdCO0FBQzdCLFdBQU96QyxpQkFBRWYsTUFBRixDQUFTNEQsUUFBVCxFQUFtQixVQUFDRSxPQUFELFVBQWFBLFFBQVFDLFNBQVIsQ0FBa0JQLFlBQWxCLEtBQW1DLEdBQWhELEVBQW5CLENBQVA7QUFDRCxHQUZNLE1BRUE7QUFDTCxXQUFPSSxRQUFQO0FBQ0Q7QUFDRjs7QUFFRCxTQUFTcEYsZUFBVCxDQUF5QkssT0FBekIsRUFBa0M7QUFDaEM7QUFDRUEsZ0JBQVksdUNBQVo7QUFDQUEsZ0JBQVksaUJBRFo7QUFFQUEsZ0JBQVksaUJBSGQ7O0FBS0Q7O0FBRURtRjtBQUNHQyxNQURILENBQ1Usa0JBRFY7QUFFR0MsT0FGSCxDQUVXLGtCQUZYLEVBRStCaEgsdUJBRi9CIiwiZmlsZSI6InphYmJpeEFQSS5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGFuZ3VsYXIgZnJvbSAnYW5ndWxhcic7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0ICogYXMgdXRpbHMgZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgJy4vemFiYml4QVBJQ29yZS5zZXJ2aWNlJztcblxuLyoqIEBuZ0luamVjdCAqL1xuZnVuY3Rpb24gWmFiYml4QVBJU2VydmljZUZhY3RvcnkoYWxlcnRTcnYsIHphYmJpeEFQSUNvcmVTZXJ2aWNlKSB7XG5cbiAgLyoqXG4gICAqIFphYmJpeCBBUEkgV3JhcHBlci5cbiAgICogQ3JlYXRlcyBaYWJiaXggQVBJIGluc3RhbmNlIHdpdGggZ2l2ZW4gcGFyYW1ldGVycyAodXJsLCBjcmVkZW50aWFscyBhbmQgb3RoZXIpLlxuICAgKiBXcmFwcyBBUEkgY2FsbHMgYW5kIHByb3ZpZGVzIGhpZ2gtbGV2ZWwgbWV0aG9kcy5cbiAgICovXG4gIGNsYXNzIFphYmJpeEFQSSB7XG5cbiAgICBjb25zdHJ1Y3RvcihhcGlfdXJsLCB1c2VybmFtZSwgcGFzc3dvcmQsIGJhc2ljQXV0aCwgd2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICB0aGlzLnVybCAgICAgICAgICAgICAgPSBhcGlfdXJsO1xuICAgICAgdGhpcy51c2VybmFtZSAgICAgICAgID0gdXNlcm5hbWU7XG4gICAgICB0aGlzLnBhc3N3b3JkICAgICAgICAgPSBwYXNzd29yZDtcbiAgICAgIHRoaXMuYXV0aCAgICAgICAgICAgICA9IFwiXCI7XG5cbiAgICAgIHRoaXMucmVxdWVzdE9wdGlvbnMgPSB7XG4gICAgICAgIGJhc2ljQXV0aDogYmFzaWNBdXRoLFxuICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHdpdGhDcmVkZW50aWFsc1xuICAgICAgfTtcblxuICAgICAgdGhpcy5sb2dpblByb21pc2UgPSBudWxsO1xuICAgICAgdGhpcy5sb2dpbkVycm9yQ291bnQgPSAwO1xuICAgICAgdGhpcy5tYXhMb2dpbkF0dGVtcHRzID0gMztcblxuICAgICAgdGhpcy5hbGVydFNydiA9IGFsZXJ0U3J2O1xuICAgICAgdGhpcy56YWJiaXhBUElDb3JlID0gemFiYml4QVBJQ29yZVNlcnZpY2U7XG5cbiAgICAgIHRoaXMuZ2V0VHJlbmQgPSB0aGlzLmdldFRyZW5kX1pCWE5FWFQxMTkzO1xuICAgICAgLy9nZXRUcmVuZCA9IGdldFRyZW5kXzMwO1xuICAgIH1cblxuICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgLy8gQ29yZSBtZXRob2Qgd3JhcHBlcnMgLy9cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgcmVxdWVzdChtZXRob2QsIHBhcmFtcykge1xuICAgICAgcmV0dXJuIHRoaXMuemFiYml4QVBJQ29yZS5yZXF1ZXN0KHRoaXMudXJsLCBtZXRob2QsIHBhcmFtcywgdGhpcy5yZXF1ZXN0T3B0aW9ucywgdGhpcy5hdXRoKVxuICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgaWYgKGlzTm90QXV0aG9yaXplZChlcnJvci5kYXRhKSkge1xuICAgICAgICAgIC8vIEhhbmRsZSBhdXRoIGVycm9yc1xuICAgICAgICAgIHRoaXMubG9naW5FcnJvckNvdW50Kys7XG4gICAgICAgICAgaWYgKHRoaXMubG9naW5FcnJvckNvdW50ID4gdGhpcy5tYXhMb2dpbkF0dGVtcHRzKSB7XG4gICAgICAgICAgICB0aGlzLmxvZ2luRXJyb3JDb3VudCA9IDA7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9naW5PbmNlKClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHRoaXMucmVxdWVzdChtZXRob2QsIHBhcmFtcykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBIYW5kbGUgQVBJIGVycm9yc1xuICAgICAgICAgIGxldCBtZXNzYWdlID0gZXJyb3IuZGF0YSA/IGVycm9yLmRhdGEgOiBlcnJvci5zdGF0dXNUZXh0O1xuICAgICAgICAgIHRoaXMuYWxlcnRBUElFcnJvcihtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWxlcnRBUElFcnJvcihtZXNzYWdlLCB0aW1lb3V0ID0gNTAwMCkge1xuICAgICAgdGhpcy5hbGVydFNydi5zZXQoXG4gICAgICAgIFwiWmFiYml4IEFQSSBFcnJvclwiLFxuICAgICAgICBtZXNzYWdlLFxuICAgICAgICAnZXJyb3InLFxuICAgICAgICB0aW1lb3V0XG4gICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdoZW4gQVBJIHVuYXV0aGVudGljYXRlZCBvciBhdXRoIHRva2VuIGV4cGlyZWQgZWFjaCByZXF1ZXN0IHByb2R1Y2UgbG9naW4oKVxuICAgICAqIGNhbGwuIEJ1dCBhdXRoIHRva2VuIGlzIGNvbW1vbiB0byBhbGwgcmVxdWVzdHMuIFRoaXMgZnVuY3Rpb24gd3JhcHMgbG9naW4oKSBtZXRob2RcbiAgICAgKiBhbmQgY2FsbCBpdCBvbmNlLiBJZiBsb2dpbigpIGFscmVhZHkgY2FsbGVkIGp1c3Qgd2FpdCBmb3IgaXQgKHJldHVybiBpdHMgcHJvbWlzZSkuXG4gICAgICogQHJldHVybiBsb2dpbiBwcm9taXNlXG4gICAgICovXG4gICAgbG9naW5PbmNlKCkge1xuICAgICAgaWYgKCF0aGlzLmxvZ2luUHJvbWlzZSkge1xuICAgICAgICB0aGlzLmxvZ2luUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShcbiAgICAgICAgICB0aGlzLmxvZ2luKCkudGhlbihhdXRoID0+IHtcbiAgICAgICAgICAgIHRoaXMuYXV0aCA9IGF1dGg7XG4gICAgICAgICAgICB0aGlzLmxvZ2luUHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm4gYXV0aDtcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMubG9naW5Qcm9taXNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhdXRoZW50aWNhdGlvbiB0b2tlbi5cbiAgICAgKi9cbiAgICBsb2dpbigpIHtcbiAgICAgIHJldHVybiB0aGlzLnphYmJpeEFQSUNvcmUubG9naW4odGhpcy51cmwsIHRoaXMudXNlcm5hbWUsIHRoaXMucGFzc3dvcmQsIHRoaXMucmVxdWVzdE9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBaYWJiaXggQVBJIHZlcnNpb25cbiAgICAgKi9cbiAgICBnZXRWZXJzaW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuemFiYml4QVBJQ29yZS5nZXRWZXJzaW9uKHRoaXMudXJsLCB0aGlzLnJlcXVlc3RPcHRpb25zKTtcbiAgICB9XG5cbiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIC8vIFphYmJpeCBBUEkgbWV0aG9kIHdyYXBwZXJzIC8vXG4gICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIGFja25vd2xlZGdlRXZlbnQoZXZlbnRpZCwgbWVzc2FnZSkge1xuICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgZXZlbnRpZHM6IGV2ZW50aWQsXG4gICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoJ2V2ZW50LmFja25vd2xlZGdlJywgcGFyYW1zKTtcbiAgICB9XG5cbiAgICBnZXRHcm91cHMoKSB7XG4gICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICBvdXRwdXQ6IFsnbmFtZSddLFxuICAgICAgICBzb3J0ZmllbGQ6ICduYW1lJyxcbiAgICAgICAgcmVhbF9ob3N0czogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgnaG9zdGdyb3VwLmdldCcsIHBhcmFtcyk7XG4gICAgfVxuXG4gICAgZ2V0SG9zdHMoZ3JvdXBpZHMpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogWyduYW1lJywgJ2hvc3QnXSxcbiAgICAgICAgc29ydGZpZWxkOiAnbmFtZSdcbiAgICAgIH07XG4gICAgICBpZiAoZ3JvdXBpZHMpIHtcbiAgICAgICAgcGFyYW1zLmdyb3VwaWRzID0gZ3JvdXBpZHM7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoJ2hvc3QuZ2V0JywgcGFyYW1zKTtcbiAgICB9XG5cbiAgICBnZXRBcHBzKGhvc3RpZHMpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogJ2V4dGVuZCcsXG4gICAgICAgIGhvc3RpZHM6IGhvc3RpZHNcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoJ2FwcGxpY2F0aW9uLmdldCcsIHBhcmFtcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IFphYmJpeCBpdGVtc1xuICAgICAqIEBwYXJhbSAge1t0eXBlXX0gaG9zdGlkcyAgaG9zdCBpZHNcbiAgICAgKiBAcGFyYW0gIHtbdHlwZV19IGFwcGlkcyAgIGFwcGxpY2F0aW9uIGlkc1xuICAgICAqIEBwYXJhbSAge1N0cmluZ30gaXRlbXR5cGUgJ251bScgb3IgJ3RleHQnXG4gICAgICogQHJldHVybiB7W3R5cGVdfSAgICAgICAgICBhcnJheSBvZiBpdGVtc1xuICAgICAqL1xuICAgIGdldEl0ZW1zKGhvc3RpZHMsIGFwcGlkcywgaXRlbXR5cGUpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogW1xuICAgICAgICAgICduYW1lJywgJ2tleV8nLFxuICAgICAgICAgICd2YWx1ZV90eXBlJyxcbiAgICAgICAgICAnaG9zdGlkJyxcbiAgICAgICAgICAnc3RhdHVzJyxcbiAgICAgICAgICAnc3RhdGUnXG4gICAgICAgIF0sXG4gICAgICAgIHNvcnRmaWVsZDogJ25hbWUnLFxuICAgICAgICB3ZWJpdGVtczogdHJ1ZSxcbiAgICAgICAgZmlsdGVyOiB7fSxcbiAgICAgICAgc2VsZWN0SG9zdHM6IFsnaG9zdGlkJywgJ25hbWUnXVxuICAgICAgfTtcbiAgICAgIGlmIChob3N0aWRzKSB7XG4gICAgICAgIHBhcmFtcy5ob3N0aWRzID0gaG9zdGlkcztcbiAgICAgIH1cbiAgICAgIGlmIChhcHBpZHMpIHtcbiAgICAgICAgcGFyYW1zLmFwcGxpY2F0aW9uaWRzID0gYXBwaWRzO1xuICAgICAgfVxuICAgICAgaWYgKGl0ZW10eXBlID09PSAnbnVtJykge1xuICAgICAgICAvLyBSZXR1cm4gb25seSBudW1lcmljIG1ldHJpY3NcbiAgICAgICAgcGFyYW1zLmZpbHRlci52YWx1ZV90eXBlID0gWzAsIDNdO1xuICAgICAgfVxuICAgICAgaWYgKGl0ZW10eXBlID09PSAndGV4dCcpIHtcbiAgICAgICAgLy8gUmV0dXJuIG9ubHkgdGV4dCBtZXRyaWNzXG4gICAgICAgIHBhcmFtcy5maWx0ZXIudmFsdWVfdHlwZSA9IFsxLCAyLCA0XTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgnaXRlbS5nZXQnLCBwYXJhbXMpXG4gICAgICAudGhlbih1dGlscy5leHBhbmRJdGVtcyk7XG4gICAgfVxuXG4gICAgZ2V0SXRlbXNCeUlEcyhpdGVtaWRzKSB7XG4gICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICBpdGVtaWRzOiBpdGVtaWRzLFxuICAgICAgICBvdXRwdXQ6IFtcbiAgICAgICAgICAnbmFtZScsICdrZXlfJyxcbiAgICAgICAgICAndmFsdWVfdHlwZScsXG4gICAgICAgICAgJ2hvc3RpZCcsXG4gICAgICAgICAgJ3N0YXR1cycsXG4gICAgICAgICAgJ3N0YXRlJ1xuICAgICAgICBdLFxuICAgICAgICB3ZWJpdGVtczogdHJ1ZSxcbiAgICAgICAgc2VsZWN0SG9zdHM6IFsnaG9zdGlkJywgJ25hbWUnXVxuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgnaXRlbS5nZXQnLCBwYXJhbXMpXG4gICAgICAudGhlbih1dGlscy5leHBhbmRJdGVtcyk7XG4gICAgfVxuXG4gICAgZ2V0TWFjcm9zKGhvc3RpZHMpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogJ2V4dGVuZCcsXG4gICAgICAgIGhvc3RpZHM6IGhvc3RpZHNcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoJ3VzZXJtYWNyby5nZXQnLCBwYXJhbXMpO1xuICAgIH1cblxuICAgIGdldEdsb2JhbE1hY3JvcygpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogJ2V4dGVuZCcsXG4gICAgICAgIGdsb2JhbG1hY3JvOiB0cnVlXG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KCd1c2VybWFjcm8uZ2V0JywgcGFyYW1zKTtcbiAgICB9XG5cbiAgICBnZXRMYXN0VmFsdWUoaXRlbWlkKSB7XG4gICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICBvdXRwdXQ6IFsnbGFzdHZhbHVlJ10sXG4gICAgICAgIGl0ZW1pZHM6IGl0ZW1pZFxuICAgICAgfTtcbiAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoJ2l0ZW0uZ2V0JywgcGFyYW1zKVxuICAgICAgLnRoZW4oaXRlbXMgPT4gaXRlbXMubGVuZ3RoID8gaXRlbXNbMF0ubGFzdHZhbHVlIDogbnVsbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybSBoaXN0b3J5IHF1ZXJ5IGZyb20gWmFiYml4IEFQSVxuICAgICAqXG4gICAgICogQHBhcmFtICB7QXJyYXl9ICBpdGVtcyAgICAgICBBcnJheSBvZiBaYWJiaXggaXRlbSBvYmplY3RzXG4gICAgICogQHBhcmFtICB7TnVtYmVyfSB0aW1lRnJvbSAgIFRpbWUgaW4gc2Vjb25kc1xuICAgICAqIEBwYXJhbSAge051bWJlcn0gdGltZVRpbGwgICBUaW1lIGluIHNlY29uZHNcbiAgICAgKiBAcGFyYW0gIHtOdW1iZXJ9IGxpbWl0W29wdGlvbmFsXSBMaW1pdGVcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gIEFycmF5IG9mIFphYmJpeCBoaXN0b3J5IG9iamVjdHNcbiAgICAgKi9cbiAgICBnZXRIaXN0b3J5KGl0ZW1zLCB0aW1lRnJvbSwgdGltZVRpbGwsIGxpbWl0KSB7XG5cbiAgICAgIC8vIEdyb3VwIGl0ZW1zIGJ5IHZhbHVlIHR5cGUgYW5kIHBlcmZvcm0gcmVxdWVzdCBmb3IgZWFjaCB2YWx1ZSB0eXBlXG4gICAgICBsZXQgZ3JvdXBlZF9pdGVtcyA9IF8uZ3JvdXBCeShpdGVtcywgJ3ZhbHVlX3R5cGUnKTtcbiAgICAgIGxldCBwcm9taXNlcyA9IF8ubWFwKGdyb3VwZWRfaXRlbXMsIChpdGVtcywgdmFsdWVfdHlwZSkgPT4ge1xuICAgICAgICBsZXQgaXRlbWlkcyA9IF8ubWFwKGl0ZW1zLCAnaXRlbWlkJyk7XG4gICAgICAgIGxldCBwYXJhbXMgPSB7XG4gICAgICAgICAgb3V0cHV0OiAnZXh0ZW5kJyxcbiAgICAgICAgICBoaXN0b3J5OiB2YWx1ZV90eXBlLFxuICAgICAgICAgIGl0ZW1pZHM6IGl0ZW1pZHMsXG4gICAgICAgICAgc29ydGZpZWxkOiAnY2xvY2snLFxuICAgICAgICAgIHNvcnRvcmRlcjogJ0FTQycsXG4gICAgICAgICAgdGltZV9mcm9tOiB0aW1lRnJvbVxuICAgICAgICB9O1xuICAgICAgICBpZiAobGltaXQpIHtcbiAgICAgICAgICBwYXJhbXMubGltaXQgPSBsaW1pdDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlbGF0aXZlIHF1ZXJpZXMgKGUuZy4gbGFzdCBob3VyKSBkb24ndCBpbmNsdWRlIGFuIGVuZCB0aW1lXG4gICAgICAgIGlmICh0aW1lVGlsbCkge1xuICAgICAgICAgIHBhcmFtcy50aW1lX3RpbGwgPSB0aW1lVGlsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoJ2hpc3RvcnkuZ2V0JywgcGFyYW1zKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oXy5mbGF0dGVuKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtIHRyZW5kcyBxdWVyeSBmcm9tIFphYmJpeCBBUElcbiAgICAgKiBVc2UgdHJlbmRzIGFwaSBleHRlbnNpb24gZnJvbSBaQlhORVhULTExOTMgcGF0Y2guXG4gICAgICpcbiAgICAgKiBAcGFyYW0gIHtBcnJheX0gIGl0ZW1zICAgICAgIEFycmF5IG9mIFphYmJpeCBpdGVtIG9iamVjdHNcbiAgICAgKiBAcGFyYW0gIHtOdW1iZXJ9IHRpbWVfZnJvbSAgIFRpbWUgaW4gc2Vjb25kc1xuICAgICAqIEBwYXJhbSAge051bWJlcn0gdGltZV90aWxsICAgVGltZSBpbiBzZWNvbmRzXG4gICAgICogQHJldHVybiB7QXJyYXl9ICBBcnJheSBvZiBaYWJiaXggdHJlbmQgb2JqZWN0c1xuICAgICAqL1xuICAgIGdldFRyZW5kX1pCWE5FWFQxMTkzKGl0ZW1zLCB0aW1lRnJvbSwgdGltZVRpbGwpIHtcblxuICAgICAgLy8gR3JvdXAgaXRlbXMgYnkgdmFsdWUgdHlwZSBhbmQgcGVyZm9ybSByZXF1ZXN0IGZvciBlYWNoIHZhbHVlIHR5cGVcbiAgICAgIGxldCBncm91cGVkX2l0ZW1zID0gXy5ncm91cEJ5KGl0ZW1zLCAndmFsdWVfdHlwZScpO1xuICAgICAgbGV0IHByb21pc2VzID0gXy5tYXAoZ3JvdXBlZF9pdGVtcywgKGl0ZW1zLCB2YWx1ZV90eXBlKSA9PiB7XG4gICAgICAgIGxldCBpdGVtaWRzID0gXy5tYXAoaXRlbXMsICdpdGVtaWQnKTtcbiAgICAgICAgbGV0IHBhcmFtcyA9IHtcbiAgICAgICAgICBvdXRwdXQ6ICdleHRlbmQnLFxuICAgICAgICAgIHRyZW5kOiB2YWx1ZV90eXBlLFxuICAgICAgICAgIGl0ZW1pZHM6IGl0ZW1pZHMsXG4gICAgICAgICAgc29ydGZpZWxkOiAnY2xvY2snLFxuICAgICAgICAgIHNvcnRvcmRlcjogJ0FTQycsXG4gICAgICAgICAgdGltZV9mcm9tOiB0aW1lRnJvbVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFJlbGF0aXZlIHF1ZXJpZXMgKGUuZy4gbGFzdCBob3VyKSBkb24ndCBpbmNsdWRlIGFuIGVuZCB0aW1lXG4gICAgICAgIGlmICh0aW1lVGlsbCkge1xuICAgICAgICAgIHBhcmFtcy50aW1lX3RpbGwgPSB0aW1lVGlsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3QoJ3RyZW5kLmdldCcsIHBhcmFtcyk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKF8uZmxhdHRlbik7XG4gICAgfVxuXG4gICAgZ2V0VHJlbmRfMzAoaXRlbXMsIHRpbWVfZnJvbSwgdGltZV90aWxsLCB2YWx1ZV90eXBlKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB2YXIgaXRlbWlkcyA9IF8ubWFwKGl0ZW1zLCAnaXRlbWlkJyk7XG5cbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogW1wiaXRlbWlkXCIsXG4gICAgICAgICAgXCJjbG9ja1wiLFxuICAgICAgICAgIHZhbHVlX3R5cGVcbiAgICAgICAgXSxcbiAgICAgICAgaXRlbWlkczogaXRlbWlkcyxcbiAgICAgICAgdGltZV9mcm9tOiB0aW1lX2Zyb21cbiAgICAgIH07XG5cbiAgICAgIC8vIFJlbGF0aXZlIHF1ZXJpZXMgKGUuZy4gbGFzdCBob3VyKSBkb24ndCBpbmNsdWRlIGFuIGVuZCB0aW1lXG4gICAgICBpZiAodGltZV90aWxsKSB7XG4gICAgICAgIHBhcmFtcy50aW1lX3RpbGwgPSB0aW1lX3RpbGw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzZWxmLnJlcXVlc3QoJ3RyZW5kLmdldCcsIHBhcmFtcyk7XG4gICAgfVxuXG4gICAgZ2V0SVRTZXJ2aWNlKHNlcnZpY2VpZHMpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogJ2V4dGVuZCcsXG4gICAgICAgIHNlcnZpY2VpZHM6IHNlcnZpY2VpZHNcbiAgICAgIH07XG4gICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KCdzZXJ2aWNlLmdldCcsIHBhcmFtcyk7XG4gICAgfVxuXG4gICAgZ2V0U0xBKHNlcnZpY2VpZHMsIHRpbWVSYW5nZSkge1xuICAgICAgbGV0IFt0aW1lRnJvbSwgdGltZVRvXSA9IHRpbWVSYW5nZTtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIHNlcnZpY2VpZHM6IHNlcnZpY2VpZHMsXG4gICAgICAgIGludGVydmFsczogW3tcbiAgICAgICAgICBmcm9tOiB0aW1lRnJvbSxcbiAgICAgICAgICB0bzogdGltZVRvXG4gICAgICAgIH1dXG4gICAgICB9O1xuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgnc2VydmljZS5nZXRzbGEnLCBwYXJhbXMpO1xuICAgIH1cblxuICAgIGdldFRyaWdnZXJzKGdyb3VwaWRzLCBob3N0aWRzLCBhcHBsaWNhdGlvbmlkcywgb3B0aW9ucykge1xuICAgICAgbGV0IHtzaG93VHJpZ2dlcnMsIG1haW50ZW5hbmNlLCB0aW1lRnJvbSwgdGltZVRvfSA9IG9wdGlvbnM7XG5cbiAgICAgIGxldCBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogJ2V4dGVuZCcsXG4gICAgICAgIGdyb3VwaWRzOiBncm91cGlkcyxcbiAgICAgICAgaG9zdGlkczogaG9zdGlkcyxcbiAgICAgICAgYXBwbGljYXRpb25pZHM6IGFwcGxpY2F0aW9uaWRzLFxuICAgICAgICBleHBhbmREZXNjcmlwdGlvbjogdHJ1ZSxcbiAgICAgICAgZXhwYW5kRGF0YTogdHJ1ZSxcbiAgICAgICAgZXhwYW5kQ29tbWVudDogdHJ1ZSxcbiAgICAgICAgbW9uaXRvcmVkOiB0cnVlLFxuICAgICAgICBza2lwRGVwZW5kZW50OiB0cnVlLFxuICAgICAgICAvL29ubHlfdHJ1ZTogdHJ1ZSxcbiAgICAgICAgZmlsdGVyOiB7XG4gICAgICAgICAgdmFsdWU6IDFcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0R3JvdXBzOiBbJ25hbWUnXSxcbiAgICAgICAgc2VsZWN0SG9zdHM6IFsnbmFtZScsICdob3N0JywgJ21haW50ZW5hbmNlX3N0YXR1cyddLFxuICAgICAgICBzZWxlY3RJdGVtczogWyduYW1lJywgJ2tleV8nLCAnbGFzdHZhbHVlJ10sXG4gICAgICAgIHNlbGVjdExhc3RFdmVudDogJ2V4dGVuZCcsXG4gICAgICAgIHNlbGVjdFRhZ3M6ICdleHRlbmQnXG4gICAgICB9O1xuXG4gICAgICBpZiAoc2hvd1RyaWdnZXJzKSB7XG4gICAgICAgIHBhcmFtcy5maWx0ZXIudmFsdWUgPSBzaG93VHJpZ2dlcnM7XG4gICAgICB9XG5cbiAgICAgIGlmIChtYWludGVuYW5jZSkge1xuICAgICAgICBwYXJhbXMubWFpbnRlbmFuY2UgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAodGltZUZyb20gfHwgdGltZVRvKSB7XG4gICAgICAgIHBhcmFtcy5sYXN0Q2hhbmdlU2luY2UgPSB0aW1lRnJvbTtcbiAgICAgICAgcGFyYW1zLmxhc3RDaGFuZ2VUaWxsID0gdGltZVRvO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KCd0cmlnZ2VyLmdldCcsIHBhcmFtcyk7XG4gICAgfVxuXG4gICAgZ2V0RXZlbnRzKG9iamVjdGlkcywgdGltZUZyb20sIHRpbWVUbywgc2hvd0V2ZW50cykge1xuICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgb3V0cHV0OiAnZXh0ZW5kJyxcbiAgICAgICAgdGltZV9mcm9tOiB0aW1lRnJvbSxcbiAgICAgICAgdGltZV90aWxsOiB0aW1lVG8sXG4gICAgICAgIG9iamVjdGlkczogb2JqZWN0aWRzLFxuICAgICAgICBzZWxlY3RfYWNrbm93bGVkZ2VzOiAnZXh0ZW5kJyxcbiAgICAgICAgc2VsZWN0SG9zdHM6ICdleHRlbmQnLFxuICAgICAgICB2YWx1ZTogc2hvd0V2ZW50c1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgnZXZlbnQuZ2V0JywgcGFyYW1zKTtcbiAgICB9XG5cbiAgICBnZXRBY2tub3dsZWRnZXMoZXZlbnRpZHMpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogJ2V4dGVuZCcsXG4gICAgICAgIGV2ZW50aWRzOiBldmVudGlkcyxcbiAgICAgICAgcHJlc2VydmVrZXlzOiB0cnVlLFxuICAgICAgICBzZWxlY3RfYWNrbm93bGVkZ2VzOiAnZXh0ZW5kJyxcbiAgICAgICAgc29ydGZpZWxkOiAnY2xvY2snLFxuICAgICAgICBzb3J0b3JkZXI6ICdERVNDJ1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgnZXZlbnQuZ2V0JywgcGFyYW1zKVxuICAgICAgLnRoZW4oZXZlbnRzID0+IHtcbiAgICAgICAgcmV0dXJuIF8uZmlsdGVyKGV2ZW50cywgKGV2ZW50KSA9PiBldmVudC5hY2tub3dsZWRnZXMubGVuZ3RoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldEFsZXJ0cyhpdGVtaWRzLCB0aW1lRnJvbSwgdGltZVRvKSB7XG4gICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICBvdXRwdXQ6ICdleHRlbmQnLFxuICAgICAgICBpdGVtaWRzOiBpdGVtaWRzLFxuICAgICAgICBleHBhbmREZXNjcmlwdGlvbjogdHJ1ZSxcbiAgICAgICAgZXhwYW5kRGF0YTogdHJ1ZSxcbiAgICAgICAgZXhwYW5kQ29tbWVudDogdHJ1ZSxcbiAgICAgICAgbW9uaXRvcmVkOiB0cnVlLFxuICAgICAgICBza2lwRGVwZW5kZW50OiB0cnVlLFxuICAgICAgICAvL29ubHlfdHJ1ZTogdHJ1ZSxcbiAgICAgICAgLy8gZmlsdGVyOiB7XG4gICAgICAgIC8vICAgdmFsdWU6IDFcbiAgICAgICAgLy8gfSxcbiAgICAgICAgc2VsZWN0TGFzdEV2ZW50OiAnZXh0ZW5kJ1xuICAgICAgfTtcblxuICAgICAgaWYgKHRpbWVGcm9tIHx8IHRpbWVUbykge1xuICAgICAgICBwYXJhbXMubGFzdENoYW5nZVNpbmNlID0gdGltZUZyb207XG4gICAgICAgIHBhcmFtcy5sYXN0Q2hhbmdlVGlsbCA9IHRpbWVUbztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgndHJpZ2dlci5nZXQnLCBwYXJhbXMpO1xuICAgIH1cblxuICAgIGdldEhvc3RBbGVydHMoaG9zdGlkcywgYXBwbGljYXRpb25pZHMsIG9wdGlvbnMpIHtcbiAgICAgIGxldCB7bWluU2V2ZXJpdHksIGFja25vd2xlZGdlZCwgY291bnQsIHRpbWVGcm9tLCB0aW1lVG99ID0gb3B0aW9ucztcbiAgICAgIGxldCBwYXJhbXMgPSB7XG4gICAgICAgIG91dHB1dDogJ2V4dGVuZCcsXG4gICAgICAgIGhvc3RpZHM6IGhvc3RpZHMsXG4gICAgICAgIG1pbl9zZXZlcml0eTogbWluU2V2ZXJpdHksXG4gICAgICAgIGZpbHRlcjogeyB2YWx1ZTogMSB9LFxuICAgICAgICBleHBhbmREZXNjcmlwdGlvbjogdHJ1ZSxcbiAgICAgICAgZXhwYW5kRGF0YTogdHJ1ZSxcbiAgICAgICAgZXhwYW5kQ29tbWVudDogdHJ1ZSxcbiAgICAgICAgbW9uaXRvcmVkOiB0cnVlLFxuICAgICAgICBza2lwRGVwZW5kZW50OiB0cnVlLFxuICAgICAgICBzZWxlY3RMYXN0RXZlbnQ6ICdleHRlbmQnLFxuICAgICAgICBzZWxlY3RHcm91cHM6ICdleHRlbmQnLFxuICAgICAgICBzZWxlY3RIb3N0czogWydob3N0JywgJ25hbWUnXVxuICAgICAgfTtcblxuICAgICAgaWYgKGNvdW50ICYmIGFja25vd2xlZGdlZCAhPT0gMCAmJiBhY2tub3dsZWRnZWQgIT09IDEpIHtcbiAgICAgICAgcGFyYW1zLmNvdW50T3V0cHV0ID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKGFwcGxpY2F0aW9uaWRzICYmIGFwcGxpY2F0aW9uaWRzLmxlbmd0aCkge1xuICAgICAgICBwYXJhbXMuYXBwbGljYXRpb25pZHMgPSBhcHBsaWNhdGlvbmlkcztcbiAgICAgIH1cblxuICAgICAgaWYgKHRpbWVGcm9tIHx8IHRpbWVUbykge1xuICAgICAgICBwYXJhbXMubGFzdENoYW5nZVNpbmNlID0gdGltZUZyb207XG4gICAgICAgIHBhcmFtcy5sYXN0Q2hhbmdlVGlsbCA9IHRpbWVUbztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdCgndHJpZ2dlci5nZXQnLCBwYXJhbXMpXG4gICAgICAudGhlbigodHJpZ2dlcnMpID0+IHtcbiAgICAgICAgaWYgKCFjb3VudCB8fCBhY2tub3dsZWRnZWQgPT09IDAgfHwgYWNrbm93bGVkZ2VkID09PSAxKSB7XG4gICAgICAgICAgdHJpZ2dlcnMgPSBmaWx0ZXJUcmlnZ2Vyc0J5QWNrbm93bGVkZ2UodHJpZ2dlcnMsIGFja25vd2xlZGdlZCk7XG4gICAgICAgICAgaWYgKGNvdW50KSB7XG4gICAgICAgICAgICB0cmlnZ2VycyA9IHRyaWdnZXJzLmxlbmd0aDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRyaWdnZXJzO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIFphYmJpeEFQSTtcbn1cblxuZnVuY3Rpb24gZmlsdGVyVHJpZ2dlcnNCeUFja25vd2xlZGdlKHRyaWdnZXJzLCBhY2tub3dsZWRnZWQpIHtcbiAgaWYgKGFja25vd2xlZGdlZCA9PT0gMCkge1xuICAgIHJldHVybiBfLmZpbHRlcih0cmlnZ2VycywgKHRyaWdnZXIpID0+IHRyaWdnZXIubGFzdEV2ZW50LmFja25vd2xlZGdlZCA9PT0gXCIwXCIpO1xuICB9IGVsc2UgaWYgKGFja25vd2xlZGdlZCA9PT0gMSkge1xuICAgIHJldHVybiBfLmZpbHRlcih0cmlnZ2VycywgKHRyaWdnZXIpID0+IHRyaWdnZXIubGFzdEV2ZW50LmFja25vd2xlZGdlZCA9PT0gXCIxXCIpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB0cmlnZ2VycztcbiAgfVxufVxuXG5mdW5jdGlvbiBpc05vdEF1dGhvcml6ZWQobWVzc2FnZSkge1xuICByZXR1cm4gKFxuICAgIG1lc3NhZ2UgPT09IFwiU2Vzc2lvbiB0ZXJtaW5hdGVkLCByZS1sb2dpbiwgcGxlYXNlLlwiIHx8XG4gICAgbWVzc2FnZSA9PT0gXCJOb3QgYXV0aG9yaXNlZC5cIiB8fFxuICAgIG1lc3NhZ2UgPT09IFwiTm90IGF1dGhvcml6ZWQuXCJcbiAgKTtcbn1cblxuYW5ndWxhclxuICAubW9kdWxlKCdncmFmYW5hLnNlcnZpY2VzJylcbiAgLmZhY3RvcnkoJ3phYmJpeEFQSVNlcnZpY2UnLCBaYWJiaXhBUElTZXJ2aWNlRmFjdG9yeSk7XG4iXX0=