2a77fcc51e7742a6d93c9567b44a4907
"use strict";Object.defineProperty(exports, "__esModule", { value: true });exports.




isGrafana2target = isGrafana2target;exports.













migrateFrom2To3version = migrateFrom2To3version;exports.







migrate = migrate; /**
                    * Query format migration.
                    * This module can detect query format version and make migration.
                    */function isGrafana2target(target) {if (!target.mode || target.mode === 0 || target.mode === 2) {if ((target.hostFilter || target.itemFilter || target.downsampleFunction || target.host && target.host.host) && target.item.filter === undefined && target.host.filter === undefined) {return true;} else {return false;}} else {return false;}}function migrateFrom2To3version(target) {target.group.filter = target.group.name === "*" ? "/.*/" : target.group.name;target.host.filter = target.host.name === "*" ? convertToRegex(target.hostFilter) : target.host.name;target.application.filter = target.application.name === "*" ? "" : target.application.name;target.item.filter = target.item.name === "All" ? convertToRegex(target.itemFilter) : target.item.name;return target;}function migrate(target) {target.resultFormat = target.resultFormat || 'time_series';if (isGrafana2target(target)) {return migrateFrom2To3version(target);
  } else {
    return target;
  }
}

function convertToRegex(str) {
  if (str) {
    return '/' + str + '/';
  } else {
    return '/.*/';
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1pZ3JhdGlvbnMuanMiXSwibmFtZXMiOlsiaXNHcmFmYW5hMnRhcmdldCIsIm1pZ3JhdGVGcm9tMlRvM3ZlcnNpb24iLCJtaWdyYXRlIiwidGFyZ2V0IiwibW9kZSIsImhvc3RGaWx0ZXIiLCJpdGVtRmlsdGVyIiwiZG93bnNhbXBsZUZ1bmN0aW9uIiwiaG9zdCIsIml0ZW0iLCJmaWx0ZXIiLCJ1bmRlZmluZWQiLCJncm91cCIsIm5hbWUiLCJjb252ZXJ0VG9SZWdleCIsImFwcGxpY2F0aW9uIiwicmVzdWx0Rm9ybWF0Iiwic3RyIl0sIm1hcHBpbmdzIjoiOzs7OztBQUtnQkEsZ0IsR0FBQUEsZ0I7Ozs7Ozs7Ozs7Ozs7O0FBY0FDLHNCLEdBQUFBLHNCOzs7Ozs7OztBQVFBQyxPLEdBQUFBLE8sRUEzQmhCOzs7c0JBS08sU0FBU0YsZ0JBQVQsQ0FBMEJHLE1BQTFCLEVBQWtDLENBQ3ZDLElBQUksQ0FBQ0EsT0FBT0MsSUFBUixJQUFnQkQsT0FBT0MsSUFBUCxLQUFnQixDQUFoQyxJQUFxQ0QsT0FBT0MsSUFBUCxLQUFnQixDQUF6RCxFQUE0RCxDQUMxRCxJQUFJLENBQUNELE9BQU9FLFVBQVAsSUFBcUJGLE9BQU9HLFVBQTVCLElBQTBDSCxPQUFPSSxrQkFBakQsSUFDQUosT0FBT0ssSUFBUCxJQUFlTCxPQUFPSyxJQUFQLENBQVlBLElBRDVCLEtBRUNMLE9BQU9NLElBQVAsQ0FBWUMsTUFBWixLQUF1QkMsU0FBdkIsSUFBb0NSLE9BQU9LLElBQVAsQ0FBWUUsTUFBWixLQUF1QkMsU0FGaEUsRUFFNEUsQ0FDMUUsT0FBTyxJQUFQLENBQ0QsQ0FKRCxNQUlPLENBQ0wsT0FBTyxLQUFQLENBQ0QsQ0FDRixDQVJELE1BUU8sQ0FDTCxPQUFPLEtBQVAsQ0FDRCxDQUNGLENBRU0sU0FBU1Ysc0JBQVQsQ0FBZ0NFLE1BQWhDLEVBQXdDLENBQzdDQSxPQUFPUyxLQUFQLENBQWFGLE1BQWIsR0FBc0JQLE9BQU9TLEtBQVAsQ0FBYUMsSUFBYixLQUFzQixHQUF0QixHQUE0QixNQUE1QixHQUFxQ1YsT0FBT1MsS0FBUCxDQUFhQyxJQUF4RSxDQUNBVixPQUFPSyxJQUFQLENBQVlFLE1BQVosR0FBcUJQLE9BQU9LLElBQVAsQ0FBWUssSUFBWixLQUFxQixHQUFyQixHQUEyQkMsZUFBZVgsT0FBT0UsVUFBdEIsQ0FBM0IsR0FBK0RGLE9BQU9LLElBQVAsQ0FBWUssSUFBaEcsQ0FDQVYsT0FBT1ksV0FBUCxDQUFtQkwsTUFBbkIsR0FBNEJQLE9BQU9ZLFdBQVAsQ0FBbUJGLElBQW5CLEtBQTRCLEdBQTVCLEdBQWtDLEVBQWxDLEdBQXVDVixPQUFPWSxXQUFQLENBQW1CRixJQUF0RixDQUNBVixPQUFPTSxJQUFQLENBQVlDLE1BQVosR0FBcUJQLE9BQU9NLElBQVAsQ0FBWUksSUFBWixLQUFxQixLQUFyQixHQUE2QkMsZUFBZVgsT0FBT0csVUFBdEIsQ0FBN0IsR0FBaUVILE9BQU9NLElBQVAsQ0FBWUksSUFBbEcsQ0FDQSxPQUFPVixNQUFQLENBQ0QsQ0FFTSxTQUFTRCxPQUFULENBQWlCQyxNQUFqQixFQUF5QixDQUM5QkEsT0FBT2EsWUFBUCxHQUFzQmIsT0FBT2EsWUFBUCxJQUF1QixhQUE3QyxDQUNBLElBQUloQixpQkFBaUJHLE1BQWpCLENBQUosRUFBOEIsQ0FDNUIsT0FBT0YsdUJBQXVCRSxNQUF2QixDQUFQO0FBQ0QsR0FGRCxNQUVPO0FBQ0wsV0FBT0EsTUFBUDtBQUNEO0FBQ0Y7O0FBRUQsU0FBU1csY0FBVCxDQUF3QkcsR0FBeEIsRUFBNkI7QUFDM0IsTUFBSUEsR0FBSixFQUFTO0FBQ1AsV0FBTyxNQUFNQSxHQUFOLEdBQVksR0FBbkI7QUFDRCxHQUZELE1BRU87QUFDTCxXQUFPLE1BQVA7QUFDRDtBQUNGIiwiZmlsZSI6Im1pZ3JhdGlvbnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFF1ZXJ5IGZvcm1hdCBtaWdyYXRpb24uXG4gKiBUaGlzIG1vZHVsZSBjYW4gZGV0ZWN0IHF1ZXJ5IGZvcm1hdCB2ZXJzaW9uIGFuZCBtYWtlIG1pZ3JhdGlvbi5cbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gaXNHcmFmYW5hMnRhcmdldCh0YXJnZXQpIHtcbiAgaWYgKCF0YXJnZXQubW9kZSB8fCB0YXJnZXQubW9kZSA9PT0gMCB8fCB0YXJnZXQubW9kZSA9PT0gMikge1xuICAgIGlmICgodGFyZ2V0Lmhvc3RGaWx0ZXIgfHwgdGFyZ2V0Lml0ZW1GaWx0ZXIgfHwgdGFyZ2V0LmRvd25zYW1wbGVGdW5jdGlvbiB8fFxuICAgICAgICAodGFyZ2V0Lmhvc3QgJiYgdGFyZ2V0Lmhvc3QuaG9zdCkpICYmXG4gICAgICAgICh0YXJnZXQuaXRlbS5maWx0ZXIgPT09IHVuZGVmaW5lZCAmJiB0YXJnZXQuaG9zdC5maWx0ZXIgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbWlncmF0ZUZyb20yVG8zdmVyc2lvbih0YXJnZXQpIHtcbiAgdGFyZ2V0Lmdyb3VwLmZpbHRlciA9IHRhcmdldC5ncm91cC5uYW1lID09PSBcIipcIiA/IFwiLy4qL1wiIDogdGFyZ2V0Lmdyb3VwLm5hbWU7XG4gIHRhcmdldC5ob3N0LmZpbHRlciA9IHRhcmdldC5ob3N0Lm5hbWUgPT09IFwiKlwiID8gY29udmVydFRvUmVnZXgodGFyZ2V0Lmhvc3RGaWx0ZXIpIDogdGFyZ2V0Lmhvc3QubmFtZTtcbiAgdGFyZ2V0LmFwcGxpY2F0aW9uLmZpbHRlciA9IHRhcmdldC5hcHBsaWNhdGlvbi5uYW1lID09PSBcIipcIiA/IFwiXCIgOiB0YXJnZXQuYXBwbGljYXRpb24ubmFtZTtcbiAgdGFyZ2V0Lml0ZW0uZmlsdGVyID0gdGFyZ2V0Lml0ZW0ubmFtZSA9PT0gXCJBbGxcIiA/IGNvbnZlcnRUb1JlZ2V4KHRhcmdldC5pdGVtRmlsdGVyKSA6IHRhcmdldC5pdGVtLm5hbWU7XG4gIHJldHVybiB0YXJnZXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtaWdyYXRlKHRhcmdldCkge1xuICB0YXJnZXQucmVzdWx0Rm9ybWF0ID0gdGFyZ2V0LnJlc3VsdEZvcm1hdCB8fCAndGltZV9zZXJpZXMnO1xuICBpZiAoaXNHcmFmYW5hMnRhcmdldCh0YXJnZXQpKSB7XG4gICAgcmV0dXJuIG1pZ3JhdGVGcm9tMlRvM3ZlcnNpb24odGFyZ2V0KTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbnZlcnRUb1JlZ2V4KHN0cikge1xuICBpZiAoc3RyKSB7XG4gICAgcmV0dXJuICcvJyArIHN0ciArICcvJztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJy8uKi8nO1xuICB9XG59XG4iXX0=